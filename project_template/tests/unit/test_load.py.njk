import unittest

import pandas as pd

from ${{ values.module_name }}.load import save_to_destination


class TestLoadData(unittest.TestCase):
    def test_load_data_success(self):
        # Sample data to load
        data = pd.DataFrame({"id": [1], "name": ["Test"]})
        destination = "test_destination.csv"

        # Assuming load_data returns True on success
        result = save_to_destination(data, destination)
        self.assertTrue(result)

    def test_load_data_failure(self):
        # Sample data with an invalid destination
        data = pd.DataFrame({"id": [1], "name": ["Test"]})
        destination = None  # Invalid destination

        # Assuming load_data raises an exception on failure
        with self.assertRaises(AttributeError):
            save_to_destination(data, destination)


if __name__ == "__main__":
    unittest.main()
